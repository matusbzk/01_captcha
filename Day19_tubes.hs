module Day19_tubes (result1, result2) where

import Data.Char

inputString :: String
inputString = "                                                                             |                                                                                                                           \n             +-------+       +-------+   +-+                                 | +-------------------------------------------+                   +---------------+     +-+ +---------------------------+   \n             |       |       |       |   | |                                 | |                                           |                   |               |     | | |                           |   \n +---------------------------+       |   | +---------------------------------|-|---------+   +-----------------------------------------------------------------|-----|-|-----+                       |   \n |           |       |               |   |                                   | |         |   |                             |                   |               |     | | |   |                       |   \n |           +-----------------------|---------------------------------------|-|---------|---|-----------------+           |                   |               | +---|-+ +-------------------------+ |   \n |                   |               |   |                                   | |         |   |                 |           |                   |               | |   |       |                     | |   \n |                   |         +-----|-+ |                 +-----------------|-+ +-------|---|-+               +---------------------------------------+       | |   | +-+   |     +-----+ +-+   +-|-|-+ \n |                   |         |     | | |                 |                 |   |       |   | |                           |                   |       |       | |   | | |   |     |     | | |   | | | | \n |           +---------------------------------------------+                 |   +-----------|-|-----------+               |                   |       |       | |   | | |   |     |     | | |   | | | | \n |           |       |         |     | | |                                   |           |   | |           |               |                   |       |       | |   | | |   |     |     | | |   | | | | \n |           | +-----|---------|-----|-|---------------+                     |           |   | |         +-|---------------|-----------+       |       |       | |   | | |   |   +-+     | | |   | | | | \n |           | |     |         |     | | |             |                     |           |   | |         | |               |           |       |       |       | |   | | |   |   |       | | |   | | | | \n |           | |     |         |     | | |             |                     |           | +----Q----------+               |           |       |       |       | |   | | |   |   |     +-|---+   | | | | \n |           | |     |         |     | | |             |                     |           | | | |         |                 |           |       |       |       | |   | | |   |   |     | | |     | | | | \n |           | |     |         |     | | |             | +---------------------------+   +-|---|---------|-------------------------------+     |     +---------|-|-----------|---|-----|---------|-+ | | \n |           | |     |         |     | | |             | |                   |       |     | | |         |                 |           | |     |     | |       | |   | | |   |   |     | | |     |   | | \n +-+ +-+     | |   +-----+     |     | +-|---------+   | |                   |       |     | | +-+       |                 |   +-------|-------------|-|---------|---|-|-----|---|-----|---|-----+   | | \n   | | |     | |   | |   |     |     |   |         |   | |                   |       |     | |   |       |                 |   |       | |     |     | |       | |   | | |   |   |     | | |         | | \n +-----|-+   | |   | |   +-----|-------------+     |   | |                   |       |     | |   |       |       +-----+   |   |   +---|-------|-----|-|-----+ | | +-|-|-|-+ | +-|---+ | | |         | | \n | | | | |   | |   | |         |     |   |   |     |   | |                   |       |     | |   |       |       |     |   |   |   |   | |     |     | |     | | | | | | | | | | |   | | | |         | | \n | | | | |   | |   | |         |     |   |   |     |   | |         +-----------------------------|-------|-------------|---------------|-------|-----+ |     +---|-|-|-|-----|-|---+ | | | |         | | \n | | | | |   | |   | |         |     |   |   |     |   | |         |         |       |     | |   |       |       |     |   |   |   |   | |     |       |       | | | | | | | | | | | | | | |         | | \n | +-----|-----|---------------|-----|---|---|---------|-|-------------------|-------------|-|---------+ |       +-------------|---|---|-------|-------|-------+ | | +---|-----|-|-------|-|-------+ | | \n |   | | |   | |   | |         |     |   |   |     |   | |         |         |       |     | |   |     | |             |   |   |   |   | |     |       |         | |   | | | | | | | | | | |       | | | \n +-------|---|-|---+ |         +-+   |   +---------|---|-|---------|---------|---------------|---|-----|---------------------------|---|-------|-------|-------------+ | | | | | | | | | | |       | | | \n     | | |   | |     |           |   |       |     |   | |         |         |       |     | |   |     | |             |   |   |   |   | |     |       |         | | | | | | | | | | | | | |       | | | \n   +-|---------|-----|-------+   |   |       |     |   | |   +---------------|-------------|-----|-------|-------------|---|-----------|-|-----|---------------------|-|-|-------------|-+ |       | | | \n   | | | |   | |     |       |   |   |       |     |   | |   |     |         |       |     | |   |     | |             |   |   |   |   | |     |       |         | | | | | | | | | | | |   |       | | | \n +-+ | +-|---------+ |       |   |   |       |     |   | |   |     |         | +-----------|-----------|-|-+     +---------|---|---|---|-|---------------------------------|-|---|---|---+ |       | | | \n |   |   |   | |   | |       |   |   |       |     |   | |   |     |         | |     |     | |   |     | | |     |     |   |   |   |   | |     |       |         | | | | | | | | | | | | | |       | | | \n |   +-------------|-|-----------|-----------------|-----|---------|-----------|-------------|---|-----|-+ |     |     |   |   |   |   +-|-------------|---------------------|-|-+ | | | | |       | | | \n |       |   | |   | |       |   |   |       |     |   | |   |     |         | |     |     | |   |     |   |     |     |   |   |   |     |     |       |         | | | | | | | |   | | | | |       | | | \n +-------+   | |   | |       |   |   |       |     +---|---+ | +-------------|-|-----------|-+   |     |   +-----|-----|-+ |   |   +-----|-----|-------|---------+ | | | | | | |   | | | | |       | | | \n             | |   | |       |   |   |       |         | | | | |   |         | |     |     |     |     |         |     | | |   |         |     |       |           | | | | | | |   | | | | |       | | | \n +-------------------------------|---|-------|---------|-|-|-------|-----------------|-----|---+ |     |   +---------------|---|---------|-----|---------------------+ | | | | |   | | | | |       | | | \n |           | |   | |       |   |   |       |         | | | | |   |         | |     |     |   | |     |   |     |     | | |   |         |     |       |           |   | | | | |   | | | | |       | | | \n |           | |   | |       | +-|-----------|---------|---|-------|---------|-------------|---------------|-----|---------|---|-------------------------------+   | +-|-|---|-|---+ | | | |       | | | \n |           | |   | |       | | |   |       |         | | | | |   |         | |     |     |   | |     |   |     |     | | |   |         |     |       |       |   | | | | | | |     | | | |       | | | \n |           | |   | |       | | | +-|-------|-----------|-|-|-|---|---------|-|---------------|-------|-------------------|-------------|-------------+       |   | | | | | | |     | | | |       | | | \n |           | |   | |       | | | | |       |         | | | | |   |         | |     |     |   | |     |   |     |     | | |   |         |     |               |   | | | | | | |     | | | |       | | | \n |           | |   | |       | | +-|-------------------|-|---|-----|-----------|-----|---------|-----------------|-------|-|---|---------|-----|-------------------|-+ | | | | |     | | | |       | | | \n |           | |   | |       | |   | |       |         | | | | |   |         | |     |     |   | |     |   |     |     | | |   |         |     |               |   |   | | | | |     | | | |       | | | \n |       +---|-|-----|-------|-------|-----------------------|-|---|---------|-----+ |     |   | |     |   +-+   |     | | |   |       +-|-----|---+           |   |   | | | | |     | +-|-------+ | | | \n |       |   | |   | |       | |   | |       |         | | | | |   |         | |   | |     |   | |     |     |   |     | | |   |       | |     |   |           |   |   | | | | |     |   | |     | | | | \n |       |   | |   | |       | |   | |       |         | | | | |   |         | |   | |     |   | | +---|---------|-----|-------|---------|---------|-----+     |   |   | | | | +---+ | +-----+   | | | | \n |       |   | |   | |       | |   | |       |         | | | | |   |         | |   | |     |   | | |   |     |   |     | | |   |       | |     |   |     |     |   |   | | | |     | | | | | |   | | | | \n |       |   | |   | |       | | +-|---------------------|---|-|---|-----------|---|-------|-----|-----|-----|-----------|-|---|---------|---------------|-+   |   |   | | | | +-+ | | | | | +-+ | | | | \n |       |   | |   | |       | | | | |       |         | | | | |   |         | |   | |     |   | | |   |     |   |     | | |   |       | |     |   |     | |   |   N   | | | | | | | | | | |   | | | | | \n |       | +-|-----|-|-------|-|-|---+       |         | | | | |   |         | |   | |     |   | | |   |     |   +-----|---|---|-----+ | |     |   |     | | +-|---|---|-------+ A | | | | | +---|-+ | | \n |       | | | |   | |       | | | |         |         | | | | X   |         | |   | |     |   | | |   |     |         | | |   |     | | |     |   |     | | | |   |   | | | |     | | | | | | | |   | | \n |       | | | |   | |       +-|-----------------------|-------|-------------|-|-----|-----|-----|---------------------|---|---------|---|-----------------|-|-----+   | | | |     | | +-----+ | |   | | \n |       | | | |   | |         | | |         |         | | | | |   |         | |   | |     |   | | |   |     |         | | |   |     | | |     |   |     | | | |       | | | |     | |   | |   | |   | | \n |       | | | |   | |         +-------------|---------|-|---|-|---|---------------|-|-----|---|-------------------------|-|-----------|-|---------------|-|-------------|-|-------|-+   | |   | |   | | \n |       | | | |   | |           | |         |         | | | | |   |         | |   | |     |   | | |   |     |         | | |   |     | | |     |   Y     | | | |       | | | |     |     | |   | |   | | \n +-------|-----|---+ |     +-----|-|-------+ |         | | | | |   |   +-----------|-|-------------|-------------+ +-------|---------|-------------|---------|---------+ | | | +-+ |     | +---|-|-----+ \n         | | | |     |     |     | |       | |         | | | | |   |   |     | |   | |     |   | | |   |     |   | |   | | |   |     | | |     |   |     | | | |         | | | | | |     |     | |   |   \n         | | | |     |     |     | |       | |         | +---|---------|-----|-----|-------|-------|---------------|-----+ |   |     | | |     |   |     | | | | +---+ +-----|-+ | +-----------|-+   |   \n         | | | |     |     |     | |       | |         |   | | |   |   |     | |   | |     |   | | |   |     |   | |   |   |   |     | | |     |   |     | | | | |   | | | | |   |       |     |     |   \n         +-|---|-----+     |     | |       | | +-------|-----+ |   |   |     | |   | |     |   | | |   |     |   | |   | +-|---------|-|-------|---|---------|-+ | +-------|-----|-+     |     |     |   \n           | | |           |     | |       | | |       |   |   |   |   |     | |   | |     |   | | |   |     |   | |   | | |   |     | | |     |   |     | | |   | | | | | | |   | |     |     |     |   \n           | | | +---+     |     | |       | +-+       |   |   |   |   |     | +-----------|-----|-----------|-------+ | | |   |     | | |     |   |     | | |   | | +-----|-|-----|-------+   |     |   \n           | | | |   |     |     | |       |           |   |   |   |   |     |     | |     |   | | |   |     |   | | | | | |   |     | | |     |   |     | | |   | |   | | | |   | |     | |   |     |   \n           | | | |   |     |     | |       |           |   |   |   |   |     +-------|-----|---|-|-|-------------|-|-|-------+ | +---|-|-|---------|-------+ +-+ | | +-|-|---|-+ | |     | |   |     |   \n           | | | |   |     |     | |       |           |   |   |   |   |           | |     |   | | |   |     |   | | | | | | | | |   | | |     |   |     |     | | | | | | | | | | |     | |   |     |   \n     +-----+ | | +---------|-----+ |       |           +-------|-+ |   |           | |     |   | | |   |   +---------|-|---|-|-------|---|-----|---|-------+ +-----|-----+ | | | +-|-----|-+   |     |   \n     |       | |     |     |       |       |               |   | | |   |           | |     |   | | |   |   | |   | | | | | | | | |   | | |     |   |     | | | | | | | |   | | |   |     |     |     |   \n     |       | |     +-------------|-------|---------------|-----|-----|-----------|-------|---|---|---|-----|-----|-----|---|-|-|---|-|-|-----|---------|-|-|-|-|-|-|-|---|-|---+ +-----|-----+     |   \n     |       | |           |       |       |               |   | | |   |           | |     |   | | |   |   | |   | | | | | | | | |   | | |     |   |     | | | | | | | |   | | | |       |           |   \n     |       | |           |   +---|-------|-------------------+ | |   |           | |     |   | | |   |   | |   | | | | | | | | |   | | |     | +-|-----------+ | | | |   | | | | +-------------+   |   \n     |       | |           |   |   |       |               |     | |   |           | |     |   | | |   |   | |   | | | | | | | | |   | | |     | | |     | | |   | | | |   | | | | |     |       |   |   \n     +---------|---------------|---|-------|---------------|-------|-----+         | | +---|---|-|-|---|-----|---|-|-----|---|---|---|-|-----------|-----|---|---|-+ | |   | | | | |     |     +-|-+ |   \n             | |           |   |   |       |               |     | |   | |         | | |   |   | | |   |   | |   | | | | | | | | |   | | |     | | |     | | |   |   | |   | | | | |     |     | | | |   \n             | |           |   | +-|-------|---------------------|-----------------|-|-----|-----------------|-----|---|-|-|---|---------------|-+ |     | | |   |   | |   | | | | |     |     | | | |   \n             | |           |   | | |       |               |     | |   | |         | | |   |   | | |   |   | |   | | | | | | | | |   | | |     |   |     | | |   |   | |   | | | | |     |     | | | |   \n             | |   +-------|-----|---------|---------------|-------|---|-|-----------|-|---|-----+ |   |   | |   | | | | | | | | |   | | |     |   |     | | |   |   | |   | | | | |     |     | | | |   \n             | |   |       |   | | |       |               |     | |   | |         | | |   |   |   |   |   | |   | | | | | | | | |   | | |     |   |     | | |   |   | |   | | | | |     |     | | | |   \n             | | +-|-------|---|-|-|-----+ |               +-----|-------------------+ |   |   |   |   |   +-|-----|-------+ | | |   | | |     |   |     | | |   |   | |   | | | | |     | +-+ | | +-|-+ \n             | | | |       |   | | |     | |                     | |   | |         |   |   |   |   |   |     |   | | | | |   | | |   | | |     |   |     | | |   |   | |   | | | | |     | | | | |   | | \n             | | | +-----------|---|-------|-+                   | |   | |         |   |   |   |   |   |     |   | | | | |   | | +---|---+     |   |     | | |   |   | |   | | | | |     | | | | |   | | \n             | | |         |   | | |     | | |                   | |   | |         |   |   |   |   |   |     |   | | | | |   | |     | |       |   |     | | |   |   | |   | | | | |     | | | | |   | | \n             | | |   +-----|---|---|-----|-|---------------------|-|-----------------------------------|-----|---|-|---|-|-----|-----|-|-------|---|---------|---|---|-------|-|-----------|-|-|-|---|-+ \n             | | |   |     |   | | |     | | |                   | |   | |         |   |   |   |   |   |     |   | | | | |   | |     | |       |   |     | | |   |   | |   | | | | |     | | | | |   |   \n +-------------|---------------|---|-----|-|-------------------+ | |   | |         |   |   |   |   |   |     |   | | +-|-|-----|-+   | |       |   |     | | |   |   | |   | | | | |     | | | | |   |   \n |           | | |   |     |   | | |     | | |                 | | |   | |         |   |   |   |   |   |     |   | |   | |   | | |   | |       |   |     | | |   |   | |   | | | | |     | | | | |   |   \n |           | | |   |     |   | | |     | | | +-------+       | | |   | |         |   |   | +-|-------------|---------|-|---|-|-----|-|-----------|-----|-|-------+ | +---------+ | +-------|-|---+ |   \n |           | | |   |     |   | | |     | | | |       |       | | |   | |         |   |   | | |   |   |     |   | |   | |   | | |   | |       |   |     | | |   | | |     | | |   | |   | | | | | | |   \n |           | | |   |     |   | | |     | | | |       |       | | |   | |         |   |   | | |   |   |     |   | |   +-|---|---+   | |       |   |     | | |   | | |     | | |   | |   | | | | | | |   \n |           | | |   |     |   | | |     | | | |       |       | | |   | |         |   |   | | |   |   |     |   | |     |   | |     | |       |   |     | | |   R | |     | | |   | |   | | | | | | |   \n |           | | |   |     |   | +-|-----|---+ |       |       | | |   | |         |   |   | | | +-----|---------|-------|---|-----+ | |       |   |     | | |   | | |     | | |   | |   +-|-|-+ | | |   \n |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | | |   | | |     | | |   | |     | |   | | |   \n |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | | +---+ | |     | | |   | |     | |   | | |   \n |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     | |   | | |   \n |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     | |   | | |   \n |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     | |   | | |   \n |           | | | +-|---------------------|-------------------|-------|-|---------|---|---|---|-------------|---|-|---------|-------|---------|---------|-|-------|-|-------|-------|-----|-+   | | |   \n |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |           | | | | |     |   |   | +---------------------------+ |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |           | | | | |     |   |   | |   | |   J       |       |   |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |           | | | | |     |   |   | |   | |   |       |       |   |   | |         |   |   | | +-|-|---------|---+ |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |           | | | | |     |   |   | |   | |   |       |       |   |   | |         |   |   | |   | |   |     |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |         +-----|-|-|-----|-------|-|---|-|-----------+       |   |   | |         |   |   | |   | |   |     |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |         | | | | | |     |   |   | |   | |   |               |   |   | |         |   |   | |   | |   |     |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |         | | | | | |     |   |   | |   | |   |               |   |   | |   +-------------|-------|---|---+ |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n |         | | | | | |     |   |   | |   | |   |               |   |   | |   |     |   |   | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n | +-------|-----|-+ |     |   |   | |   | |   |               |   |   | |   |     |   |   | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n | |       | | | |   |     |   |   | |   | |   |               |   |   | |   |     |   |   | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n | |     +---|-|-----|-----+   |   | |   | |   |     +---------|---------|---|-----|---|---|-------|---|---|-------|---------|-------|-|-------|-----------|-------|---+   | | |   | |   +---------+ |   \n | |     | | | | |   |         |   | |   | |   |     |         |   |   | |   |     |   |   | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | |   | |   | |     |   |   \n | +---------|---|-------------|---------|-|---|---------------|---|---|-----|-+   |   +-----|---|-|---|---|-------|-----|---------|---|-------|---|-------|-------|-|-------|---+ | |   | |     |   +-+ \n |       | | | | |   |         |   | |   | |   |     |         |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | | | | |   | |     |     | \n | +-----|-+ | | | +-|-----+   |   | |   | |   |     |         |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | | | | |   | |     |     | \n | |     |   | | | | C     |   |   | |   | |   |     |         |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | | | | |   | |     |     | \n | |     | +---|-+ +-------|---|---------|-|---------|-------------------|---|-----|-------|-------|---|---|-|-----|-----|-----|---|-|-|-------|---------------------|-----|-----|-+ |   | |     |     | \n | |     | | | |     |     |   |   | |   | |   |     |         |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | | |   |   | |     |     | \n | +-----|-|-|-|---+ |     |   |   | |   | |   |     |       +-|-------|-----|-|-------------|---------|---|-|-----|---------------|---------------------+ |       | | |   | | | |   |   | |     |     | \n |       | | | |   | |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |       |       | | |   | | | |   |   | |     |     | \n | +-------|-----+ +-|-----|---|-----|---|-----|-----|---------|---|---|-|-------------------|---|---------+ |     |     |   | |   | | |       |   |       |       | | |   | | | |   |   | |     |     | \n | |     | | | | |   |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |     |     |     |   | |   | | |       |   |       |       | | |   | | | |   |   | |     |     | \n +-|-----------|-|-+ |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |     |     |     |   | |   | | |       |   |       |       | | +---|-|-+ |   |   | |     |     | \n   |     | | | | | | |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |     |     |     |   | |   | | |       |   |       |       | |     | |   |   |   | |     |     | \n   +-+   | | | | +-|-------|---|---|-----|-|---------|-------|-----------|-----|-------------------|---|-----|-----+     |   | |   | | |       |   |       |       | +-----|-|--D----|---|-+     |     | \n     |   | | | |   | |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |     |           |   | |   | | |       |   |       |       |       | |   |   |   |       |     | \n     |   | | | |   | |     |   |   | |   | | +-|-------------|-|---|---|-------+   |       +-------|---|-----|-----------|-----|---------------|-+ |       |       |       | |   |   |   |       |     | \n     |   | | | |   | |     |   |   | |   | | | |     |       | |   |   | |   |     |         |   | |   |     |           |   | |   | | |       | | |       |       |       | |   |   |   |       |     | \n     |   | | | |   | |     |   |   | |   | | | |     |       | |   |   | |   |     | +-----------|-----|-----|---------------------|-------------|-|-------+       |       | |   |   |   |       |     | \n     |   | | | |   | |     |   |   | |   | | | |     |       | |   |   | |   |     | |       |   | |   |     |           |   | |   | | |       | | |               |       | |   |   |   |       |     | \n     |   | | | |   +-|---------|---|-|---|-+ | |     |       | |   +---|-|---|-------|-------|---|-|---|---------------------+ |   | | |       | +-------------------------|-|---+   |   |       |     | \n     |   | | | |     |     |   |   | |   |   | |     |       | |       | |   |     | |       |   | |   |     |           |     |   | | |       |   |               |       | |       |   |       |     | \n     |   | | | |     |     |   |   | |   |   | |     |       | |       | |   |     | |       |   | |   |     |           | +---|---|-------------------------------|-------------+   |   |       |     | \n     |   | | | |     |     |   |   | |   |   | |     |       | |       | |   |     | |       |   | |   |     |           | |   |   | | |       |   |               |       | |   |   |   |       |     | \n +---+ +-+ +---------|---------------|---|-----------------+ | |       | |   |     | |       |   | |   |     |           | |   |   | | |       |   |               |       | +-------|-----------|-----+ \n |     |     | |     |     |   |   | |   |   | |     |     | | |       | |   |     | |       |   | |   |     |           | |   |   | | |       |   |               |       |     |   |   |       |       \n |     |     +-|-----|-----|---|---|-|-------|-------------|-|---------|-------+   | |       |   | |   |     |           | |   |   | | |       |   |               |       |     |   |   |       +-----+ \n |     |       |     |     |   |   | |   |   | |     |     | | |       | |   | |   | |       |   | |   |     |           | |   |   | | |       |   |               |       |     |   |   |             | \n |     |       |     |     |   +---------------------|---------|-------------|-|-------------|---|-|-----------------------|---|---+ | |       |   |               |       |     |   |   |             | \n |     |       |     |     |       | |   |   | |     |     | | |       | |   | |   | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n |     |       |     |     |       | |   |   | |     |     | | |       | |   | |   | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n |     |       |     |     |       | |   |   | |     |     | | |       | |   | |   | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n |     |       | +---|-------------|-----|---|-|-----|-------------------|-----+   | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n |     |       | |   |     |       | |   |   | |     |     | | |       | |   |     | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n +-+   | +-+   | |   |     |       | |   |   | |     +-----|-------------|---|-----|-|-------|-----------------------------|---|-----|-|-------|---------------------------|-----|-------|-------------+ \n   |   | | |   | |   |     |       | |   |   | |           | | |       | |   |     | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |               \n +-----|-|-------|---------|---------|---|-------------------|-----------|-----------|-----------------------------------|-|---------|-|-------|-----------------+ |       |     |   |   |               \n | |   | | |   | |   |     |       | |   |   | |           | | |       | |   |     | |       |   | |   |     |           | |   |     | |       |   |             | |       |     |   |   |               \n | |   | | |   | |   |     |       | |   |   | +-----------|-|-----------|---|-----|-------------|-----|-----|---------+ | |   |     | |       |   |             | |       |     |   |   |               \n | |   | | |   | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n | |   | | +-+ | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n | |   | |   | | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n | |   | |   | | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n | |   | |   | | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n | |   | |   | | |   |     |       | |   |   |   +---------+ | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |       +-----|---------------+   |   |               \n | |   | |   | | |   |     |       | |   |   |   |           | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |       |     | |       |         |   |               \n | +---|-+ +-|-------------|-------------------+ |           | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |       |     | |       |         |   |               \n |     |   | | | |   |     |       | |   |   | | |           | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |       |     | |       |         |   |               \n | +---+ +-|---|-----+     |       | |   |   | | |           | +-----------------------------|-+ | |   |     |         | | |   +-----|-|-------|-+ |       |     | |       |         |   |               \n | |     | | | | |         |       | |   |   | | |           |         | |   |     | |       | | | |   |     |         | | |         | |       | | |       |     | |       |         |   |               \n | |     | | | | |         |       | +---|---|-|-------------|---------|-----------------------|-------|-----|-----------|-------------|-------|-|---------|-------|-------|---------+   |               \n | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |         | | |         | |       | | |       |     | |       |             |               \n | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |         | | |         | |       | | |       +-------|-------|-------+     |               \n | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |         | | |         | |       | | |             | |       |       |     |               \n | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |         +-|-|---------|-------------|-------------|---------------------------------+     \n | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |           | |         | |       | | |             | |       |       |     |         |     \n | |     | | | | |         |       |     |   | | |           |         | +---|-----|-|-------|---|-|---------|-----------|-|-----------+       | | +-------------------------------|-----+         |     \n | |     | | | | |         |       |     |   | | |           |         |     |     | |       | | | |   |     |           | |         |         | |               | |       |       |               |     \n | |     +---|-|-|---------------+ |     |   | | | +-------------------|-+   |     | |       | | | |   |     |           | |         |         | |               | |       |       |               |     \n | |       | | | |         |     | |     |   | | | |         |         | |   |     | |       | | | |   |     |           | |         |         | |               | |       |       |               |     \n +-+   +-+ | | | |         |     | |     |   | | | |         |         | |   |     | |       | +-+ |   |     +-------------+         |         | |               | |       |       |               |     \n       | | | | | |         |     | |     |   | | | |         |         | |   |     | |       |     |   |                 |           |         | |               | |       |       |               |     \n +-------+ | +-|-|-+       |     | |     | +-----|-|---------|-----------|---------|-|-------|---------|-----------------------------|-----------+               | |       |       +---------------|---+ \n |     |   |   | | |       |     | |     | | | | | |         |         | |   |     | |       |     |   |                 |           |         |                 | |       |                       |   | \n |   +---------+ | |       |     +-|-------|-----|-----------|-----------|---|-------|-----+ |     |   |                 |           |         |                 | |       |                       |   | \n |   | |   |     | |       |       |     | | | | | |         |         | |   |     | |     | |     |   |                 |           |         |                 | |       |                       |   | \n |   | | +-|-----|-|---------------|-----|-|---|-----------------------|-----|-----+ |     +-|-----|---|-----------------|---------------------+                 | |       |                       |   | \n |   | | | |     | |       |       |     | | | | | |         |         | |   |       |       |     |   |                 |           |                           | |       |                       |   | \n |   | | | | +-------------+       |     +-|-+ | | |         |         | |   |       |       | +-------|-----------------|-----------+                           | |       |                       |   | \n |   | | | | |   | |               |       |   | | |         |         | |   |       |       | |   |   |                 |                                       | |       |                       |   | \n | +---|-|-+ |   | | +-------------|-------|---|---|-------------------+ |   +-----+ |       | +---|---------------------|---------------------------------------|-|-----------------------------------+ \n | | | | |   |   | | |             |       |   | | |         |           |         | |       |     |   |                 |                                       | |       |                       |     \n +-|-------------|---+         +---|-------+ +---|-|---------------------|-----------|-------------|---|-----------------|---------------------------------------|-|-------|---------------------------+ \n   | | | |   |   | |           |   |         | | | |         |           |         | |       |     |   |                 |                                       | |       |                       |   | \n   | | | |   |   | |       +-------------+   | | | |         |           |         | |       +-----|---------------------|-----------------------------------------|-----------------------------------+ \n   | | | |   |   | |       |   |   |     |   | | | |         |           |         | |             |   |                 |                                       | |       |                       |     \n   | | | +---|-----|----------F----|-----|---+ | | +-+       |           |         | |             |   |                 |   +-----------------------------------|-------------------------------------+ \n   | | |     |   | |       |   |   |     |     | |   |       |           |         | |             |   |                 |   |                                   | |       |                       |   | \n   | +-|-----|-----------------|-----------------------------|-----------------------|-------------|---------------------|---|---------------------+             | |       |                 +-+   | +-+ \n   |   |     |   | |       |   |   |     |     | |   |       |           |         | |             |   |                 |   |                     |             | |       |                 | |   | |   \n   |   |     |   | |       |   |   +-----------|-|-----------|-----------|---------|-|-------------|---|---------------------|---------------------+             | |       |                 | |   | |   \n   |   |     |   | |       |   |         |     | |   |       |           |         | |             |   |                 |   |                                   | |       |                 | |   | |   \n   |   |     |   | |       +---|---------|-------+   |       |           |         | |             |   |                 +---------------------------------------|---------------------------+ |   | |   \n   |   |     |   | |           |         |     |     |       |           |         | |             |   |                     |                                   | |       |                   |   | |   \n   |   |     |   | +-----------+         |     +-+   |       |           +---------|-------------------|---------------------+         +---------------------------+       |                   |   | |   \n   |   |     |   |                       |       |   |       |                     | |             |   |                               |                         |         |                   |   | |   \n +-+   |   +-----|-----------------------|-------|---|-------+                     +-+             +---|-------------------------------+                         |     +---+                   |   +-+   \n |     |   | |   |                       |       |   |                                                 |                                                         |     |                       |         \n +-----+   +-+   +-----------------------+       +---+                                                 +---------------------------------------------------------+     +-----------------------+         \n                                                                                                                                                                                                         \n"

-- |Represents the map - two dimensional list
type Mapa = [[Char]]

-- |Represents direction. I'm using DLeft and DRight because of Data.Either
data Direction = Up | Down | DLeft | DRight
              deriving (Eq, Show)

-- |Represents position in the map
type Position = (Int, Int)

-- |Represents the current state:
-- if I have not found the result yet then 
--  position
--  direction
--  list of found chars in wrong order
--  number of steps done
-- if I found the result then
--  list of found chars
--  number of steps done
data State = Computing Position Direction [Char] Int
           | Done [Char] Int
           deriving Show

-- |Map from input
input :: Mapa
input = lines inputString

-- |Takes a position and returns what character is on that position
onPos :: Position -> Char
onPos (x,y) = input!!y!!x

-- |Starting position
startState :: State
startState = Computing (findStart $ head input, 0) Up [] 0

-- |Takes a list of chars and returns the position of '|'
findStart :: [Char] -> Int
findStart [] = error "Did not find start"
findStart ('|':_) = 0
findStart (_:xs) = 1 + findStart xs

-- |Performs a move - takes a state and finds the next one
move :: State -> State
move (Computing (x,y) Up list steps)
   | elem (onPos (x,y)) "|-" = Computing (x,y+1) Up list (steps + 1)
   | isLetter $ onPos (x,y)  = Computing (x,y+1) Up (onPos (x,y) : list) (steps + 1)
   | onPos (x,y) == '+'      = if onPos (x+1,y) == ' ' 
                                then Computing (x-1,y) DLeft list (steps + 1)
                                else Computing (x+1,y) DRight list (steps + 1)
   | otherwise               = Done (reverse list) steps
move (Computing (x,y) Down list steps)
   | elem (onPos (x,y)) "|-" = Computing (x,y-1) Down list (steps + 1)
   | isLetter $ onPos (x,y)  = Computing (x,y-1) Down (onPos (x,y) : list) (steps + 1)
   | onPos (x,y) == '+'      = if onPos (x+1,y) == ' ' 
                                then Computing (x-1,y) DLeft list (steps + 1)
                                else Computing (x+1,y) DRight list (steps + 1)
   | otherwise               = Done (reverse list) steps
move (Computing (x,y) DRight list steps)
   | elem (onPos (x,y)) "|-" = Computing (x+1,y) DRight list (steps + 1)
   | isLetter $ onPos (x,y)  = Computing (x+1,y) DRight (onPos (x,y) : list) (steps + 1)
   | onPos (x,y) == '+'      = if onPos (x,y+1) == ' ' 
                                then Computing (x,y-1) Down list (steps + 1)
                                else Computing (x,y+1) Up list (steps + 1)
   | otherwise               = Done (reverse list) steps
move (Computing (x,y) DLeft list steps)
   | elem (onPos (x,y)) "|-" = Computing (x-1,y) DLeft list (steps + 1)
   | isLetter $ onPos (x,y)  = Computing (x-1,y) DLeft (onPos (x,y) : list) (steps + 1)
   | onPos (x,y) == '+'      = if onPos (x,y+1) == ' ' 
                                then Computing (x,y-1) Down list (steps + 1)
                                else Computing (x,y+1) Up list (steps + 1)
   | otherwise               = Done (reverse list) steps
move (Done l s) = Done l s

-- |Computes the whole thing and returns
-- found letters and number of steps
compute :: State -> ([Char],Int)
compute (Done l s) = (l,s)
compute st = compute $ move st

-- |Found letters
result1 :: [Char]
result1 = fst . compute $ startState

-- |Number of steps
result2 = snd . compute $ startState
